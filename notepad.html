<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¡ãƒ¢ã®å…¥åŠ›ã¨ç¢ºèª</title>
    <style>
		body {
		  font-family: Arial, sans-serif;
		  font-size: 16px;   /* â† ã“ã‚Œè¿½åŠ  */
		  padding: 20px;
		  max-width: 500px;
		  margin: auto;
		  background-color: #ffe6ff;
		}
        
		.app-header {
		  background: #8080ff;
		  color: white;

		  display: flex;
		  align-items: center;        /* â† ç¸¦ä¸­å¤® */
		  justify-content: space-between;

		  padding: 10px 14px;         /* â† ä½™ç™½ã‚’æœ€å°é™ã« */
		  
		}

		.app-header h1 {
	  	  /* margin: 0;   */    /* â† ã“ã‚Œè¶…é‡è¦ */
  		  margin-left: 30px; /* â† å·¦ã«30pxã®ä½™ç™½ */  
		  font-size: 18px;
		  font-weight: normal;
		}
          
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            max-width: 600px;
            margin: auto;
            background-color: #cbe4e4;
        }
        
		.detail-container {
		    padding: 8px 10px;
		}
        
		.input-row {
		    display: flex;
		    flex-direction: column;
		    align-items: flex-start;
		    margin-left: 8px;
		    width: 100%;
		}
		
		.input-row label {
		    margin: 6px 0 2px 0;   /* ä¸Šä¸‹ã ã‘ */
		}

		.input-row input,
		.input-row textarea,
		.input-row select {
		    margin: 0 0 8px 0;     /* å·¦å³ã‚¼ãƒ­ */
		}
		.input-row textarea {
		  width: 100%;
		  min-height: 200px;   /* â† 150 â†’ 180 */
		  max-height: 300px;
		}

		.input-row,
		.input-row * {
		    box-sizing: border-box;
		}

        .input-row input {
            height: 30px;
            font-size: 16px;
        }
        
		.url-box {
		    width: 94%;           /* â† 90 â†’ 94 ã§ååˆ†åŠ¹ã */
		    max-width: 560px;     /* â† 10pxã ã‘å¢—ã‚„ã™ */
		    margin-left: 8px;     /* â† ãƒ©ãƒ™ãƒ«ã¨æƒã† */
		    margin-right: auto;
		}

		#memoContent {
		  font-size: 1rem;
		}
        
        .table-container {
            width: 100%;
            overflow-x: auto;
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            word-wrap: break-word;
            white-space: pre-wrap;
        }
        th.keyword-column, td.keyword-column {
            width: 60%;
        }
        th.actions-column, td.actions-column {
            width: 40%;
        }
        #memoList {
            width: 100%;
        }
        button {
            font-size: 15px;
            padding: 3px 7px; /* ãƒœã‚¿ãƒ³ã®ä½™ç™½ã‚’èª¿æ•´ */
            margin: 3px;
            border-radius: 5px;
            background-color: #d9ffd9;
            color: black;
            border: 1px solid #0000ff;
            cursor: pointer;
		    white-space: nowrap;
		    line-height: 1.2;            
        }
        .save-button {
            padding: 3px 7px;
            background-color: #ffdbed;
        }
        .copy-button {
            padding: 3px 7px;
            background-color: #ffe8e8;
        }                     
        .close-list-button {
            background-color: #c1ffff;
        }
	  
        .custom-alert {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ffcccb;
            color: black;
            padding: 10px 20px;
            border: 1px solid red;
            border-radius: 5px;
            font-size: 16px;
            z-index: 1000;
        }

		.detail-container {
    		margin: 10px 0;
		    background-color: #f2f2f2;
		    word-break: break-all; /* é•·ã„URLã‚’å¼·åˆ¶çš„ã«æ”¹è¡Œ */
		}

	    footer {
	      text-align: center;
	      padding: 12px;
          font-size: 15px;	
          color: #b87272;                
	    }	

		/* 11/4 Top/Bottomãƒœã‚¿ãƒ³ */
		.bottom-button, .top-button {
		    position: fixed;
		    bottom: 20px;
		    left: 50%;
		    transform: translateX(-50%);
		    background: #a74fff;
		    color: white;
		    border: none;
		    border-radius: 20px;
		    padding: 10px 20px;
		    font-size: 16px;
		    cursor: pointer;
		    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
		    z-index: 9999;
		    display: none;
		}
		.bottom-button:hover, .top-button:hover {
		    background: #0056b3;
		}    
	
	    /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ 5/6 */
	    .top-right-button {
          width: auto; /* ãƒœã‚¿ãƒ³ã®å¹…ã‚’è‡ªå‹•èª¿æ•´ */
  		  position: static;   /* â† absolute ã‚’ã‚„ã‚ã‚‹ */
	      top: 10px;
	      right: 10px;
	      background-color: #ccffff;
	      color: black;
	      border-radius: 20px;
	      padding: 6px 12px;
	      font-size: 14px;
    	  border: 1px solid black; /* æ ç·šã‚’è¡¨ç¤º */	      
	      cursor: pointer;
	    }
	    .top-right-button:hover {
	      background-color: #f4f4f4;
	    }

		.category-row {
		  display: flex;
		  align-items: center;   /* é«˜ã•ã‚’æƒãˆã‚‹ */
		  gap: 30px;             /* select ã¨ãƒœã‚¿ãƒ³ã®é–“éš” */
		  margin-bottom: 8px;
		  flex-wrap: wrap;       /* ã‚¹ãƒãƒ›ã§ç‹­ã‘ã‚Œã°æŠ˜ã‚Šè¿”ã™ */
		}

		.category-row select {
		  height: 30px;
		  font-size: 16px;
		}

		@media (max-width: 600px) {
		  th, td {
		    padding: 4px 4px;
		    font-size: 14.5px;
			line-height: 1.4;
		  }
		}

    /* 2/5 */
    #keyNButton {
        background-color: #c89191;
        color: white;
        min-width: 72px;
        padding: 3px 7px;
        font-size: 15px;
        white-space: nowrap;
        line-height: 1.2;
    }
    
    </style>
    
	<script>
	function openOCRReader() {
	  if (typeof Android !== "undefined" && Android.openOCRReader) {
	    Android.openOCRReader(); // WebViewå†…ãªã‚‰ã‚¢ãƒ—ãƒªå´ã¸
	  } else {
	    window.open(
	      'https://ettomio0518.github.io/ettomio-ocr-reader/',
	      '_blank'
	    ); // é€šå¸¸ãƒ–ãƒ©ã‚¦ã‚¶ãªã‚‰ç›´æ¥é–‹ã
	  }
	}
	</script>
	    
</head>
<body>

<header class="app-header">
  <h1>ğŸ“ğŸ”’ ãƒãƒ¼ãƒˆ notepad</h1>
  <button class="top-right-button"
    onclick="window.location.href='index.html'">æˆ»ã‚‹</button>
</header>
  	
<div class="container">
  	    
		<div class="input-row">
        <label for="keyword">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:</label>
        <input type="text" id="keyword" maxlength="20" onfocus="showKeywordAlert(); this.onfocus=null;" class="input-field">
		<div class="category-row">
		  <select id="category" class="input-field">
		    <option value="1">è¦šãˆ</option>
		    <option value="2">å€‹äºº</option>
		    <option value="3">ä»•äº‹ãƒ»å­¦ç¿’</option>
		    <option value="4">è¶£å‘³ãƒ»å¨¯æ¥½</option>
		    <option value="5">ãã®ä»–</option>
		    <option value="6">å¾Œã§èª­ã‚€</option>
		  </select>

		  <button onclick="openOCRReader()">ç°¡æ˜“ç‰ˆOCR</button>
		</div>
         
        <label for="memoContent">ãƒãƒ¼ãƒˆå†…å®¹:</label>
        <textarea id="memoContent" rows="5" class="input-field" style="width: 100%;"></textarea>
	<div>	        
        <button class="save-button" onclick="saveMemo()">ğŸ’¾ ä¿å­˜</button>
		<button id="keyNButton" onclick="location.href='AdvancedSearch.html?from=notepad'">é«˜æ©Ÿèƒ½æ¤œç´¢</button>      
    	<button class="copy-button" onclick="copyNote()">å…¨é¸æŠã‚³ãƒ”ãƒ¼</button>
    	
    </div>
    
    <button id="toggleMemoList" onclick="toggleMemoList()" style="margin-top: 15px;margin-bottom: 8px;"> ãƒãƒ¼ãƒˆã®ãƒªã‚¹ãƒˆ </button>

    <div id="memoList" class="table-container"></div>
	<div class="url-box">
        <label for="urlContent" style="color: #800000;">ãƒãƒ¼ãƒˆè©³ç´° (ã‚¯ãƒªãƒƒã‚«ãƒ–ãƒ«å¯¾å¿œ):</label>
        <div id="urlContent" class="detail-container"></div>
    </div>
    <button id="closeMemoListBottom" class="close-list-button" style="display: none;" onclick="toggleMemoList()">ãƒªã‚¹ãƒˆã‚’é–‰ã˜ã‚‹</button>
</div>
</div>
<script>
    let currentKey = '';
    let isMemoListDisplayed = false;

    function showCustomAlert(message) {
        const alertContainer = document.createElement('div');
        alertContainer.className = 'custom-alert';
        alertContainer.textContent = message;
        document.body.appendChild(alertContainer);
        setTimeout(() => {
            document.body.removeChild(alertContainer);
        }, 5000);
    }

    function showKeywordAlert() {
        showCustomAlert("ä¸€ç›®ã§åˆ†ã‹ã‚‹10æ–‡å­—ç¨‹åº¦ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥ã‚Œã¦ä¸‹ã•ã„ã€‚æœ¬æ–‡ã«ã¯é‡è¦ãªå†…å®¹ã¯æ›¸ãè¾¼ã¾ã‚Œãªã„ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚");
    }

	function saveMemo() {
	    const keyword = document.getElementById('keyword').value.trim();
	    const category = document.getElementById('category').value;

	    const textarea = document.getElementById('memoContent');
	    const originalText = textarea.value;

	    // è¡Œå˜ä½ã§åˆ†è§£ â†’ ç©ºç™½è¡Œã‚’ã™ã¹ã¦å‰Šé™¤
	    const lines = originalText.split(/\r?\n/);
	    const cleanedLines = lines.filter(line => line.trim() !== '');
	    const cleanedText = cleanedLines.join('\n');

	    // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯
	    if (keyword.length < 1) {
	        showCustomAlert(
	          "ä¸€ç›®ã§åˆ†ã‹ã‚‹10æ–‡å­—ç¨‹åº¦ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥ã‚Œã¦ä¸‹ã•ã„ã€‚æœ¬æ–‡ã«ã¯é‡è¦ãªå†…å®¹ã¯æ›¸ãè¾¼ã¾ã‚Œãªã„ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚"
	        );
	        return;
	    }

	    const newKey = `memo_${category}_${keyword}`;
	    localStorage.setItem(newKey, cleanedText);

	    // æ—§ã‚­ãƒ¼å‰Šé™¤
	    if (currentKey && currentKey !== newKey) {
	        localStorage.removeItem(currentKey);
	    }

	    // ä¿å­˜ç¢ºèª
	    if (localStorage.getItem(newKey) === cleanedText) {
	        if (originalText !== cleanedText) {
	            showCustomAlert('ç©ºç™½è¡Œã‚’æ•´ç†ã—ã¦ä¿å­˜ã—ã¾ã—ãŸã€‚');
	        } else {
	            showCustomAlert('ãƒ¡ãƒ¢ãŒä¿å­˜ã•ã‚Œã¾ã—ãŸã€‚');
	        }
	    } else {
	        showCustomAlert('ãƒ¡ãƒ¢ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
	    }

	    // åˆæœŸåŒ–
	    document.getElementById('keyword').value = '';
	    textarea.value = '';
	    document.getElementById('category').value = '1';
	    currentKey = '';
	    displayMemos();
	}

	function copyNote() {
	    const text = document.getElementById('memoContent').value;

	    navigator.clipboard.writeText(text).then(() => {
	        showCustomAlert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ—ãƒªã‚„å¤–éƒ¨ã‚¢ãƒ—ãƒªã«è²¼ã‚Šä»˜ã‘ã¦ã”åˆ©ç”¨ãã ã•ã„ã€‚');
	    });
	}

    function displayMemos() {
        const keys = Object.keys(localStorage).filter(key => key.startsWith('memo_'));
        const categorizedMemos = {};

        keys.forEach(key => {
            const parts = key.split('_');
            const category = parts[1];
            const keyword = parts[2];
            if (!categorizedMemos[category]) {
                categorizedMemos[category] = [];
            }
            categorizedMemos[category].push({ key, keyword });
        });

        const memoList = document.getElementById('memoList');
        memoList.innerHTML = '';

		const table = document.createElement('table');
        Object.keys(categorizedMemos).sort().forEach(category => {
            const categoryRow = document.createElement('tr');
            const categoryCell = document.createElement('td');
            categoryCell.colSpan = 2;
            categoryCell.textContent = `${category}.${document.querySelector(`#category option[value="${category}"]`).textContent}`;
			categoryCell.style.fontSize = 'larger'; // ã“ã“ã§ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤§ããã—ã¾ã™
			categoryCell.style.color =  ' #0000ff'; // æ–‡å­—è‰²é’
			// ã‚ã„ã¯ categoryCell.style.cssText = 'font-size: larger; color: blue;';

            categoryRow.appendChild(categoryCell);
            table.appendChild(categoryRow);

            categorizedMemos[category].sort((a, b) => a.keyword.localeCompare(b.keyword)).forEach(memo => {
                const row = document.createElement('tr');
                const keywordCell = document.createElement('td');
                const actionsCell = document.createElement('td');
                keywordCell.textContent = memo.keyword;
                keywordCell.style.wordBreak = 'break-all'; // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒ10æ–‡å­—ç¨‹åº¦ã§æŠ˜ã‚Šè¿”ã™ã‚ˆã†ã«ä¿®æ­£

                const viewButton = document.createElement('button');
                viewButton.textContent = 'è¡¨ç¤º';
                viewButton.onclick = () => {
                    document.getElementById('keyword').value = memo.keyword;
                    document.getElementById('memoContent').value = localStorage.getItem(memo.key);
                    document.getElementById('category').value = category;
                    displayURLs(localStorage.getItem(memo.key));
                    currentKey = memo.key;
                    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });// æœ€ä¸‹æ®µã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                };

                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'æ¶ˆå»';
                deleteButton.onclick = () => deleteMemo(memo.key);

                actionsCell.appendChild(viewButton);
                actionsCell.appendChild(deleteButton);
                actionsCell.style.whiteSpace = 'nowrap'; // ãƒœã‚¿ãƒ³ãŒæ¨ªä¸¦ã³ã«ãªã‚‹ã‚ˆã†ã«ä¿®æ­£

                row.appendChild(keywordCell);
                row.appendChild(actionsCell);
                table.appendChild(row);
            });
        });

        memoList.appendChild(table);
    }

    function deleteMemo(key) {
        localStorage.removeItem(key);
        showCustomAlert('ãƒ¡ãƒ¢ãŒæ¶ˆå»ã•ã‚Œã¾ã—ãŸã€‚');
        displayMemos();
    }

    function toggleMemoList() {
        const memoList = document.getElementById('memoList');
        const toggleButton = document.getElementById('toggleMemoList');
        const closeButtonBottom = document.getElementById('closeMemoListBottom'); // è¿½åŠ 

        if (isMemoListDisplayed) {
            memoList.style.display = 'none';
            toggleButton.textContent = 'ãƒãƒ¼ãƒˆã®ãƒªã‚¹ãƒˆ';
            toggleButton.classList.remove('close-list-button');
            closeButtonBottom.style.display = 'none'; // è¿½åŠ 
            document.getElementById('keyword').value = '';
            document.getElementById('memoContent').value = '';
            document.getElementById('category').value = '1';
            document.getElementById('urlContent').innerHTML = '';
        } else {
            displayMemos();
            memoList.style.display = 'block';
            toggleButton.textContent = 'ãƒªã‚¹ãƒˆã‚’é–‰ã˜ã‚‹';
            toggleButton.classList.add('close-list-button');
            closeButtonBottom.style.display = 'block'; // è¿½åŠ 
        }
        isMemoListDisplayed = !isMemoListDisplayed;
    }

	function displayURLs(memoContent) {
	    const urlContainer = document.getElementById('urlContent');
	    urlContainer.innerHTML = ''; // æ—¢å­˜ã®URLã‚’ã‚¯ãƒªã‚¢

	    const urlRegex = /(https?:\/\/[^\s]+)/g;
	    const formattedContent = memoContent.replace(urlRegex, (url) => `<a href="${url}" style="color: blue; text-decoration: underline;" target="_blank">${url}</a>`); // target="_blank"ã‚’è¿½åŠ 
	    urlContainer.innerHTML = formattedContent.replace(/\n/g, '<br>');
	}

    document.getElementById('memoList').style.display = 'none';
</script>

	    <button class="top-button" id="topBtn" onclick="scrollToTop()">Top</button>
		<button class="bottom-button" id="bottomBtn" onclick="scrollToBottom()">Bottom</button>
	    

  <script>
	    // ==========================================================
	    // â˜… ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³åˆ¶å¾¡ (Top/Bottom)
	    // ==========================================================

	    function scrollToTop() {
	      window.scrollTo({ top: 0, behavior: 'smooth' });
	    }

	    function scrollToBottom() {
	      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
	    }

	    function hideScrollButtons() {
	        document.getElementById("topBtn").style.display = "none";
	        document.getElementById("bottomBtn").style.display = "none";
	    }

		// ==========================================================
		// â˜… ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³åˆ¶å¾¡ã®ä¿®æ­£ç‰ˆ (Top/Bottom ç‹¬ç«‹åˆ¶å¾¡) 12/02
		// ==========================================================
		function showScrollButtonsIfPageLong() {
		    const topBtn = document.getElementById("topBtn");
		    const bottomBtn = document.getElementById("bottomBtn");
		    
		    const docHeight = document.body.scrollHeight;
		    const viewHeight = window.innerHeight;
		    const scrollY = window.scrollY;
		    
		    const scrollThreshold = 100; // ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã—ãã„å€¤ (px)
		    
		    // ãƒšãƒ¼ã‚¸ãŒã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã§ãªã‘ã‚Œã°ä¸¡æ–¹éè¡¨ç¤º
		    if (docHeight <= viewHeight + scrollThreshold) {
		        topBtn.style.display = "none";
		        bottomBtn.style.display = "none";
		        return;
		    }

		    // --- Topãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡ ---
		    // 100pxä»¥ä¸Šã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ãŸã‚‰Topãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
		    if (scrollY > scrollThreshold) {
		        topBtn.style.display = "block";
		    } else {
		        topBtn.style.display = "none";
		    }

			// --- Bottomãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡ ---
			// 100pxä»¥ä¸Šã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« ã‹ã¤ ä¸‹ç«¯ã¾ã§ä½™è£•ãŒã‚ã‚‹å ´åˆã®ã¿è¡¨ç¤º
			if (
			    scrollY > scrollThreshold &&
			    docHeight - viewHeight - scrollY > scrollThreshold
			) {
			    bottomBtn.style.display = "block";
			} else {
			    bottomBtn.style.display = "none";
			}
		}

	    // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ™‚ã®ãƒœã‚¿ãƒ³è¡¨ç¤ºåˆ¶å¾¡
	    window.addEventListener("scroll", showScrollButtonsIfPageLong);
	    
	    // åˆæœŸãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚‚ãƒœã‚¿ãƒ³è¡¨ç¤ºã‚’ãƒã‚§ãƒƒã‚¯
	    window.addEventListener("load", showScrollButtonsIfPageLong);
	    
	    // ç”»é¢ã‚µã‚¤ã‚ºå¤‰æ›´æ™‚ã«ã‚‚ãƒã‚§ãƒƒã‚¯ (ã‚¹ãƒãƒ›ã®å‘ãå¤‰æ›´ãªã©)
	    window.addEventListener("resize", showScrollButtonsIfPageLong);


	    // ==========================================================
	    // â˜… åˆæœŸåŒ–
	    // ==========================================================
	    // åˆæœŸåŒ–å‡¦ç†ã¯DOMContentLoadedãŒå®Œäº†ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å®Ÿè¡Œã•ã‚Œã‚‹
	    document.addEventListener('DOMContentLoaded', () => {
	        showScrollButtonsIfPageLong();
	    });
	    
  </script>
    
  <footer>
  Â© 20260207 ettomio - èˆã„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
  </footer>
  <div style="height: 50px;"></div>
  
  </body>
</html>

