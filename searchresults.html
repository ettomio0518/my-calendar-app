<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¤œç´¢çµæœ</title>
    <link rel="stylesheet" href="styles.css">
    
	<style>
		body {
		    font-family: Arial, sans-serif;
		    font-size: 16px;
		    margin: 7px;
		    background-color: #ffffc4;
		}
		.container {
		    display: flex;
		    flex-direction: column;
		    align-items: center;
		    padding: 20px;
		    max-width: 600px;
		    margin: auto;
		    background-color: #cbe4e4;
		}
		header {
		  background: #55aaaa;
		  color: white;
		  padding: 1em 0; /* ä¸Šä¸‹ã®ä½™ç™½ã‚’ã‚‚ã†å°‘ã—ã ã‘èª¿æ•´ */
		  text-align: center;
		  position: relative;
		}
		h1 {
		  font-size: 20px;
		  margin: 0;
		}    	            

		.input-row {
		    display: flex;
		    flex-direction: row;
		    align-items: center;
		    margin-bottom: 10px;
		    width: 100%;
		}
		.input-row label, .input-row input, .input-row button {
		    margin: 5px;
		}
		.input-row input {
		    flex-grow: 1;
		    height: 30px;
		    font-size: 16px;
		}
		.table-container {
		    width: 100%;
		    overflow-x: auto;
		    margin-top: 20px;
		}
		table {
		    width: 100%;
		    border-collapse: collapse;
		}
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            word-wrap: break-word;
            white-space: pre-wrap;
        }
        		
		th.keyword-column, td.keyword-column {
		    width: 20%;
		    max-width: 6ch; /* ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®æ–‡å­—æ•°åˆ¶é™ */
		}

		th.content-column, td.content-column {
		    width: 60%;
		    max-width: 10ch; /* å†…å®¹ã®æ–‡å­—æ•°åˆ¶é™ */
		}

		th.actions-column, td.actions-column {
		    width: 20%;
	    	text-align: center;		    
		}
		
		td.actions-column button {
		    display: inline-block; /* ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ã§ä¸­å¤®å¯„ã› */
		}
			
		#fullContent {
		    width: 100%;
		    border: 1px solid #ddd;
		    padding: 10px;
		    margin-top: 20px;
		    white-space: pre-wrap;
		    background-color: #ffffff;
		}
		button {
		    font-size: 16px;
		    padding: 5px 10px;
		    margin: 5px;
		    border-radius: 5px;
		    background-color: #f7eeff;
		    color: black;
		    border: 1px solid #0000ff;
		    cursor: pointer;
		}

	    .btn-show-text {  /* 3/15ã«è¿½åŠ  */
	        font-size: 14px;
	        padding: 0px 2px;
	        padding: 3px 5px; /* ãƒœã‚¿ãƒ³ã®ä½™ç™½ã‚’èª¿æ•´ */
	        background-color: #ffeaf4;
	        color: black;
	        border: 1px solid #0000ff;
	        border-radius: 5px;            
	        cursor: pointer;
	        min-width: 60px;   /* æœ€å°å¹…ã‚’è¨­å®š */
	        display: inline-block; /* æ¨ªä¸¦ã³ã«ã™ã‚‹ */
	    }        
		.detail-container {
		    background-color: #f2f2f2;
		    word-break: break-all; /* é•·ã„URLã‚’å¼·åˆ¶çš„ã«æ”¹è¡Œ */
		}

	    footer {
	      text-align: center;
	      font-size: 0.85em;
	      margin: 10px 0 80px;
	      color: #666;
	    }
	    
		/* 11/4 Top/Bottomãƒœã‚¿ãƒ³ */
		.bottom-button, .top-button {
		    position: fixed;
		    bottom: 20px;
		    left: 50%;
		    transform: translateX(-50%);
		    background: #007bff;
		    color: white;
		    border: none;
		    border-radius: 20px;
		    padding: 10px 20px;
		    font-size: 16px;
		    cursor: pointer;
		    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
		    z-index: 9999;
		    display: none;
		}
		.bottom-button:hover, .top-button:hover {
		    background: #0056b3;
		}

	    /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ 5/6 */
	    .top-right-button {
          width: auto; /* ãƒœã‚¿ãƒ³ã®å¹…ã‚’è‡ªå‹•èª¿æ•´ */
	      position: absolute;
	      top: 5px;
	      right: 10px;
	      background-color: #ccffff;
	      color: black;
	      border-radius: 20px;
	      padding: 6px 12px;
	      font-size: 14px;
    	  border: 1px solid black; /* æ ç·šã‚’è¡¨ç¤º */	      
	      cursor: pointer;
	    }
	    .top-right-button:hover {
	      background-color: #f4f4f4;
	    }

	    footer {
	      text-align: center;
	      padding: 12px;
	      font-size: 15px;	
	      color: #b87272;                
	    }	
	    	    		        		
	</style>

</head>

<body>

  	<header>
    <!-- Homeã«æˆ»ã‚‹ãƒœã‚¿ãƒ³ 5/6 -->
	    <button class="top-right-button" onclick="location.href='index.html'">æˆ»ã‚‹</button>
	    <h1>âœ¨ æ¤œç´¢çµæœ ğŸ’¡</h1>
  	</header>

    <div class="container">

        <div id="searchResults" class="table-container"></div>
        <div id="fullContent" class="detail-container"></div>
        <button id="closeButton" style="display: none;" onclick="closeFullContent()">è©³ç´°ã‚’é–‰ã˜ã‚‹</button>
    </div>

    <script>
        function makeUrlsClickable(text) {
            const urlPattern = /(https?:\/\/[^\s]+)/g;
            return text.replace(urlPattern, '<a href="$1" target="_blank" rel="noopener noreferrer">$1</a>');
        }

        function displayFullContent(content) {
            const fullContentDiv = document.getElementById('fullContent');
            const closeButton = document.getElementById('closeButton');
            fullContentDiv.innerHTML = makeUrlsClickable(content);
            fullContentDiv.style.display = 'block';
            closeButton.style.display = 'block'; // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
            fullContentDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function closeFullContent() {
            const fullContentDiv = document.getElementById('fullContent');
            const closeButton = document.getElementById('closeButton');
            fullContentDiv.style.display = 'none'; // è©³ç´°è¡¨ç¤ºã‚’éè¡¨ç¤º
            closeButton.style.display = 'none'; // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º
        }

        function searchMemos() {
            const keyword = localStorage.getItem('searchKeyword');
            const keys = Object.keys(localStorage).filter(key => key !== 'searchKeyword'); // "searchKeyword"ã‚’é™¤å¤–
            const searchResults = keys.filter(key => {
                const content = localStorage.getItem(key);
                return content.includes(keyword);
            });

            // ã‚­ãƒ¼ã‚’æ˜‡é †ã«ä¸¦ã¹æ›¿ãˆ
            searchResults.sort((a, b) => a.localeCompare(b));

            const searchResultsList = document.getElementById('searchResults');
            searchResultsList.innerHTML = '';

            const table = document.createElement('table');
            const headerRow = document.createElement('tr');
            const keywordHeader = document.createElement('th');
            keywordHeader.classList.add('keyword-column');
            keywordHeader.textContent = 'key';
            const contentHeader = document.createElement('th');
            contentHeader.classList.add('content-column');
            contentHeader.textContent = 'å†…å®¹';
            const actionsHeader = document.createElement('th');
            actionsHeader.classList.add('actions-column');
            actionsHeader.textContent = 'æ“ä½œ';
            headerRow.appendChild(keywordHeader);
            headerRow.appendChild(contentHeader);
            headerRow.appendChild(actionsHeader);
            table.appendChild(headerRow);

            searchResults.forEach(key => {
                const row = document.createElement('tr');
                const keywordCell = document.createElement('td');
                keywordCell.classList.add('keyword-column');
                const contentCell = document.createElement('td');
                contentCell.classList.add('content-column');
                const actionsCell = document.createElement('td');
                actionsCell.classList.add('actions-column');
                const content = localStorage.getItem(key);

                keywordCell.textContent = key.slice(0, 10); // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®è¡¨ç¤ºã‚’10æ–‡å­—ã«åˆ¶é™
                contentCell.textContent = content.slice(0, 30) + '...'; // å†…å®¹ã®ä¸€éƒ¨ã‚’è¡¨ç¤º

                const viewButton = document.createElement('button');
                viewButton.textContent = 'è¡¨ç¤º';
				viewButton.classList.add('btn-show-text'); // ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ  
				
                viewButton.onclick = () => displayFullContent(content);

                actionsCell.appendChild(viewButton);
                row.appendChild(keywordCell);
                row.appendChild(contentCell);
                row.appendChild(actionsCell);
                table.appendChild(row);
            });

            searchResultsList.appendChild(table);
        }

        window.onload = searchMemos;
    </script>
    
    <button class="top-button" id="topBtn" onclick="scrollToTop()">Top</button>
	<button class="bottom-button" id="bottomBtn" onclick="scrollToBottom()">Bottom</button>

  <script>
    // ==========================================================
    // â˜… ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³åˆ¶å¾¡ (Top/Bottom)
    // ==========================================================

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function scrollToBottom() {
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    function hideScrollButtons() {
        document.getElementById("topBtn").style.display = "none";
        document.getElementById("bottomBtn").style.display = "none";
    }

    // â˜… ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³åˆ¶å¾¡ (Top/Bottom) 11/6
function showScrollButtonsIfPageLong() {
    const topBtn = document.getElementById("topBtn");
    const bottomBtn = document.getElementById("bottomBtn");
    
    // ãƒšãƒ¼ã‚¸ãŒååˆ†ã«é•·ã„ã‹ãƒã‚§ãƒƒã‚¯ (ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒçŸ­ã„å ´åˆã¯ãƒœã‚¿ãƒ³ä¸è¦)
    const scrollThreshold = 300;
    const isScrollable = document.body.scrollHeight > window.innerHeight + scrollThreshold; 

    if (!isScrollable) {
        hideScrollButtons();
        return;
    }

    // ãƒšãƒ¼ã‚¸ãŒé•·ã„å ´åˆã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã«ã‚ˆã‚‹åˆ¶å¾¡
    const scrollY = window.scrollY;
    const docHeight = document.body.scrollHeight;
    const viewHeight = window.innerHeight;
    const bottomMargin = docHeight - viewHeight - scrollY; // ç”»é¢ä¸‹ç«¯ã‹ã‚‰ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸‹ç«¯ã¾ã§ã®è·é›¢
    
    // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã®åˆ¤å®š
    if (scrollY > scrollThreshold) {
        // [ã‚±ãƒ¼ã‚¹1] ã‚ã‚‹ç¨‹åº¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ãŸ -> Topãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º (Bottomãƒœã‚¿ãƒ³ã¯éè¡¨ç¤º)
        topBtn.style.display = "block";
        bottomBtn.style.display = "none";
    } else if (scrollY === 0 && bottomMargin > scrollThreshold) {
        // [ã‚±ãƒ¼ã‚¹2 - ä¿®æ­£ç®‡æ‰€] ãƒšãƒ¼ã‚¸æœ€ä¸Šéƒ¨ï¼ˆscrollY=0ï¼‰ã«ã„ã‚‹å ´åˆ -> Bottomãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º
        topBtn.style.display = "none";
        bottomBtn.style.display = "none"; 
    } else if (bottomMargin > scrollThreshold) {
        // [ã‚±ãƒ¼ã‚¹3] ãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã«ã„ã‚‹ãŒã€åº•éƒ¨ã¯ã¾ã é ã„ -> Bottomãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
        // ãŸã ã—ã€ã“ã®else ifã«åˆ°é”ã™ã‚‹ã®ã¯ scrollY > 0 ã®æ™‚ã®ã¿ (ã‚±ãƒ¼ã‚¹2ã§å¼¾ã‹ã‚Œã‚‹ãŸã‚)
        topBtn.style.display = "none";
        bottomBtn.style.display = "block";
    } else {
        // [ã‚±ãƒ¼ã‚¹4] ãƒšãƒ¼ã‚¸ã®ä¸‹ç«¯è¿‘ãã«ã„ã‚‹
        topBtn.style.display = "none";
        bottomBtn.style.display = "none";
    }
}

    // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ™‚ã®ãƒœã‚¿ãƒ³è¡¨ç¤ºåˆ¶å¾¡
    window.addEventListener("scroll", showScrollButtonsIfPageLong);
    
    // åˆæœŸãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚‚ãƒœã‚¿ãƒ³è¡¨ç¤ºã‚’ãƒã‚§ãƒƒã‚¯
    window.addEventListener("load", showScrollButtonsIfPageLong);
    
    // ç”»é¢ã‚µã‚¤ã‚ºå¤‰æ›´æ™‚ã«ã‚‚ãƒã‚§ãƒƒã‚¯ (ã‚¹ãƒãƒ›ã®å‘ãå¤‰æ›´ãªã©)
    window.addEventListener("resize", showScrollButtonsIfPageLong);


    // ==========================================================
    // â˜… åˆæœŸåŒ–
    // ==========================================================
    // åˆæœŸåŒ–å‡¦ç†ã¯DOMContentLoadedãŒå®Œäº†ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å®Ÿè¡Œã•ã‚Œã‚‹
    document.addEventListener('DOMContentLoaded', () => {
        showScrollButtonsIfPageLong();
    });
	    
  </script>
  
	  <footer>
	  Â© 20260207 ettomio - èˆã„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
	  </footer>
	  
</body>

</html>
