<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜æ©Ÿèƒ½æ¤œç´¢</title>
    <link rel="stylesheet" href="styles.css">
    
	<style>   
	/* åŸºæœ¬ã®ã‚¹ã‚¿ã‚¤ãƒ« */
	body {
	    font-family: Arial, sans-serif;
	    font-size: 15px;
	    margin: 7px;
	    background-color: #ffffc4;
	}

	.container {
	    display: flex;
	    flex-direction: column;
	    align-items: center;
	    padding: 20px;
	    max-width: 600px;
	    margin: auto;
	    background-color: #cbe4e4;
	}

	header {
	  background: #55aaaa;
	  color: white;
	  padding: 1em 0; /* ä¸Šä¸‹ã®ä½™ç™½ã‚’ã‚‚ã†å°‘ã—ã ã‘èª¿æ•´ */
	  text-align: center;
	  position: relative;
	}
	h1 {
	  font-size: 20px;
	  margin: 0;
	}    	            

	/* å…¥åŠ›ãƒœãƒƒã‚¯ã‚¹ */
	input[type="text"] {
	    all: unset;
	    display: block;
	    width: 100%;
	    height: 40px;
	    font-size: 16px;
	    box-sizing: border-box;
	    background-color: #ffffff; /* èƒŒæ™¯ã‚’ç™½ */
	    color: #000000; /* æ–‡å­—è‰²ã‚’é»’ */
	    border: 1px solid #0000ff; /* é’ã„æ ç·š */
	    padding: 5px; /* å†…å´ã®ä½™ç™½ */
	    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* è»½ã„å½± */
	}

	input[type="text"]:focus {
	    border-color: #ff0000; /* ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã«èµ¤ã„æ ç·š */
	    outline: none; /* ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³å‰Šé™¤ */
	}

	/* ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
	.table-container {
	    width: 100%;
	    overflow-x: auto;
	    margin-top: 20px;
	}

	table {
	    width: 100%;
	    border-collapse: collapse;
	}

	th, td {
	    border: 1px solid #ddd;
	    padding: 8px;
	    text-align: left;
	    word-wrap: break-word;
	    white-space: pre-wrap;
	}

	th.keyword-column, td.keyword-column {
	    width: 20%;
	    max-width: 6ch; /* ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®æ–‡å­—æ•°åˆ¶é™ */
	}

	th.content-column, td.content-column {
	    width: 60%;
	    max-width: 10ch; /* å†…å®¹ã®æ–‡å­—æ•°åˆ¶é™ */
	}

	th.actions-column, td.actions-column {
	    width: 20%;
	    text-align: center;	   
	}

	td.actions-column button {
	    display: inline-block; /* ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ã§ä¸­å¤®å¯„ã› */
	}
	
	/* è©³ç´°è¡¨ç¤º */
	#fullContent {
	    width: 100%;
	    border: 1px solid #ddd;
	    padding: 10px;
	    margin-top: 20px;
	    background-color: #ffffff; /* èƒŒæ™¯ã‚’ç™½ */
	    white-space: pre-wrap;
	}

	/* ãƒœã‚¿ãƒ³ */
	button {
	    font-size: 14px;
	    padding: 5px 10px;
	    margin: 5px;
	    border-radius: 5px;
	    background-color: #f7eeff;
	    color: black;
	    border: 1px solid #0000ff;
	    cursor: pointer;
	}

	
	.closeButton {
	    font-size: 16px;
	    padding: 5px 10px;
	    margin: 5px;
	    border-radius: 5px;
	    background-color: #c4ffc4;
	    color: black;
	    border: 1px solid #0000ff;
	    cursor: pointer;
	}
    .btn-show-text {  /* 3/15ã«è¿½åŠ  */
        font-size: 14px;
        padding: 0px 2px;
        padding: 3px 5px; /* ãƒœã‚¿ãƒ³ã®ä½™ç™½ã‚’èª¿æ•´ */
        background-color: #ffeaf4;
        color: black;
        border: 1px solid #0000ff;
        border-radius: 5px;            
        cursor: pointer;
        min-width: 60px;   /* æœ€å°å¹…ã‚’è¨­å®š */
        display: inline-block; /* æ¨ªä¸¦ã³ã«ã™ã‚‹ */
    }
	/* è©³ç´°ã‚³ãƒ³ãƒ†ãƒŠ */
	.detail-container {
	    background-color: #f2f2f2;
	    word-break: break-all;
	}

	button, a {
	    cursor: pointer; /* ã‚«ãƒ¼ã‚½ãƒ«ã‚’æ‰‹ã®å½¢ã« */
	}
	#saveButton, #closeButton {
	    cursor: pointer; /* ã‚«ãƒ¼ã‚½ãƒ«ã‚’æ‰‹ã®å½¢ã« */
	}


	/* ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¯ã‚¨ãƒªã«ã‚ˆã‚‹ã‚¹ãƒãƒ›å¯¾å¿œ */
	@media only screen and (max-width: 600px) {
	    td.keyword-column {
	        max-width: 6ch; /* ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ—ã®å¹…åˆ¶é™ */
	    }
	    td.content-column {
	        max-width: 10ch; /* å†…å®¹åˆ—ã®å¹…åˆ¶é™ */
	    }
	    table, th, td {
	        font-size: 16px; /* ãƒ†ã‚­ã‚¹ãƒˆã‚µã‚¤ã‚ºèª¿æ•´ */
	    }
	    #keywordInput {
	        height: 30px; /* ã‚¹ãƒãƒ›ç”¨ã®é«˜ã• */
	    }
	}
	
    #topButton {
        margin-top: 20px; /* ä¸Šã¨ã®ä½™ç™½ */
        justify-content: center; /* æ°´å¹³æ–¹å‘ã®ä¸­å¤®æƒãˆ */        
        padding: 10px 20px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
    }
    #topButton:hover {
        background-color: #0056b3;
    }	
    
    /* Topãƒœã‚¿ãƒ³ï¼šæœ€åˆã¯éè¡¨ç¤ºã«ã—ã¦ãŠãã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§è¡¨ç¤º 5/5 */
    .top-button {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #007bff;
      color: white;
      border: none;
      border-radius: 20px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      z-index: 9999;
      display: none; /* æœ€åˆã¯éè¡¨ç¤º */
    }
    .top-button:hover {
      background: #0056b3;
    }

    /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ 5/6 */
    .top-right-button {
      width: auto; /* ãƒœã‚¿ãƒ³ã®å¹…ã‚’è‡ªå‹•èª¿æ•´ */
      position: absolute;
      top: 5px;
      right: 10px;
      background-color: #ccffff;
      color: black;
      border-radius: 20px;
      padding: 6px 12px;
      font-size: 14px;
	  border: 1px solid black; /* æ ç·šã‚’è¡¨ç¤º */	      
      cursor: pointer;
    }
    .top-right-button:hover {
      background-color: #f4f4f4;
    }

	/* 8/11 è¿½åŠ  */	
	#voiceButton {
	    color: #4d0000;
	    background-color: #c8ffe3;
	    border-radius: 5px;
	    border: 1px solid #0000ff;
	}

	@keyframes blink {
	  0% { opacity: 1; }
	  50% { opacity: 0.3; }
	  100% { opacity: 1; }
	}

	.blinking {
	  animation: blink 1s infinite;
	}

	#voiceButton.recording {
	    color: red !important;
	    background-color: #ffd0d0 !important;
	}

	/* ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆ */
	.custom-alert { 
	    position: fixed; 
	    top: 20px; 
	    left: 50%; 
	    transform: translateX(-50%); 
	    background-color: #333; 
	    color: white; 
	    padding: 15px 25px; 
	    border-radius: 5px; 
	    box-shadow: 0 2px 10px rgba(0,0,0,0.2); 
	    z-index: 1000; 
	    font-size: 1em; 
	}
		
	</style>
	
</head>

<body>
  	<header>
    <!-- Homeã«æˆ»ã‚‹ãƒœã‚¿ãƒ³ 5/6 -->
	    <button class="top-right-button" onclick="location.href='index.html'">æˆ»ã‚‹</button>
	    <h1>é«˜æ©Ÿèƒ½æ¤œç´¢</h1>
  	</header>
  	
    <div class="container">

        <!-- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›ãƒœãƒƒã‚¯ã‚¹ -->
        <div>
            <label for="keywordInput">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:</label>
            <!-- éŸ³å£°å…¥åŠ›ãƒœã‚¿ãƒ³ -->
<button id="voiceButton" onclick="startVoiceInput()">ğŸ¤ éŸ³å£°å…¥åŠ›</button>
            <input type="text" id="keywordInput" oninput="searchMemos()" placeholder="æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
        </div>

        <!-- æ¤œç´¢çµæœè¡¨ç¤º -->
        <div id="searchResults" class="table-container"></div>

        <!-- è©³ç´°è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div id="fullContent" class="detail-container" contenteditable="true"></div>
        <button id="saveButton" style="display: none;" onclick="saveChanges()">ä¿®æ­£ã—ã¦ä¿å­˜</button>
        <button id="closeButton" class="closeButton" style="display: none;" onclick="closeFullContent()">è©³ç´°ã‚’é–‰ã˜ã‚‹</button>


    <script>
		// 8/10,8/11 8/13è¿½åŠ ã€€CoPilot    
		let recognition;
		let isListening = false;

		// ã‚«ã‚¹ã‚¿ãƒ é€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
		function showCustomAlert(message) {
		    const alertContainer = document.createElement('div');
		    alertContainer.className = 'custom-alert';
		    alertContainer.textContent = message;

		    document.body.appendChild(alertContainer);

		    setTimeout(() => {
		        document.body.removeChild(alertContainer);
		    }, 2000);
		}

		// éŸ³å£°å…¥åŠ›ã‚’é–‹å§‹ã™ã‚‹é–¢æ•°
		function startVoiceInput() {
		    const voiceButton = document.getElementById('voiceButton');

		    if (!recognition) {
		        if ('webkitSpeechRecognition' in window) {
		            recognition = new webkitSpeechRecognition();
		        } else if ('SpeechRecognition' in window) {
		            recognition = new SpeechRecognition();
		        } else {
		            recognition = null;
		            voiceButton.style.display = "none";
		            showCustomAlert('ã“ã®ç«¯æœ«ã§ã¯éŸ³å£°å…¥åŠ›ãŒä½¿ãˆã¾ã›ã‚“ã€‚æ‰‹å‹•å…¥åŠ›ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚');
		            return;
		        }

		        recognition.lang = 'ja-JP';
		        recognition.interimResults = false;
		        recognition.maxAlternatives = 1;

		        recognition.onresult = function(event) {
		            const transcript = event.results[0][0].transcript;
		            document.getElementById('keywordInput').value = transcript;
		            searchMemos();
		            toggleVoiceButton(true); // ã€ŒâŒ ã‚¯ãƒªã‚¢ã€ãƒœã‚¿ãƒ³ã«åˆ‡ã‚Šæ›¿ãˆ
		        };

		        recognition.onerror = function(event) {
		            alert('éŸ³å£°èªè­˜ã‚¨ãƒ©ãƒ¼: ' + event.error);
		            showCustomAlert('æ‰‹å‹•å…¥åŠ›ã‚’ãŠé¡˜ã„ã—ã¾ã™');
		            voiceButton.style.display = "none";
		        };
		    }

		    recognition.start();
		    isListening = true;

		    voiceButton.classList.add("blinking");
		    voiceButton.classList.add("recording");
		}

		// ãƒœã‚¿ãƒ³è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹é–¢æ•°
		function toggleVoiceButton(isClearMode) {
		    const voiceButton = document.getElementById('voiceButton');
		    if (isClearMode) {
		        voiceButton.textContent = 'âŒ ã‚¯ãƒªã‚¢';
		        voiceButton.onclick = clearVoiceInput;
		        voiceButton.classList.remove("blinking");
		        voiceButton.classList.remove("recording");
		    } else {
		        voiceButton.textContent = 'ğŸ¤ éŸ³å£°å…¥åŠ›';
		        voiceButton.onclick = startVoiceInput;
		        voiceButton.classList.remove("blinking");
		        voiceButton.classList.remove("recording");
		    }
		}

		// ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªã‚¢ã—ã¦å…¨ãƒªã‚¹ãƒˆè¡¨ç¤ºã«æˆ»ã™é–¢æ•°
		function clearVoiceInput() {
		    document.getElementById('keywordInput').value = '';
		    searchMemos();
		    toggleVoiceButton(false); // ã€ŒéŸ³å£°å…¥åŠ›ã€ãƒœã‚¿ãƒ³ã«æˆ»ã™
		}

		// DOMèª­ã¿è¾¼ã¿å¾Œã®åˆæœŸåŒ–
		document.addEventListener('DOMContentLoaded', function () {
		    const voiceButton = document.getElementById('voiceButton');
		    const keywordInput = document.getElementById('keywordInput');

		    if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
		        voiceButton.style.display = "none";
		        showCustomAlert('ã“ã®ç«¯æœ«ã§ã¯éŸ³å£°å…¥åŠ›ãŒä½¿ãˆã¾ã›ã‚“ã€‚æ‰‹å‹•å…¥åŠ›ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚');
		    } else {
		        voiceButton.onclick = startVoiceInput;
		        toggleVoiceButton(false);
		    }

		    // æ‰‹å‹•å…¥åŠ›ãŒå§‹ã¾ã£ãŸã‚‰ã€ŒâŒ ã‚¯ãƒªã‚¢ã€ãƒœã‚¿ãƒ³ã«åˆ‡ã‚Šæ›¿ãˆ
		    keywordInput.addEventListener('input', function () {
		        if (this.value.trim() !== '') {
		            voiceButton.style.display = "inline-block";
		            toggleVoiceButton(true);
		        }
		    });
		});

		// ã“ã“ã¾ã§		

        let currentKey = null; // ç¾åœ¨è¡¨ç¤ºã—ã¦ã„ã‚‹keyã‚’ä¿æŒ

        // URLã‚’ãƒªãƒ³ã‚¯ã«å¤‰æ›ã™ã‚‹é–¢æ•°
        function makeUrlsClickable(text) {
            const urlPattern = /(https?:\/\/[^\s]+)/g;
            return text.replace(urlPattern, '<a href="$1" target="_blank" rel="noopener noreferrer">$1</a>');
        }

        // è©³ç´°ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function displayFullContent(content, key) {
            const fullContentDiv = document.getElementById('fullContent');
            const saveButton = document.getElementById('saveButton');
            const closeButton = document.getElementById('closeButton');

            currentKey = key; // ç¾åœ¨ã®ã‚­ãƒ¼ã‚’ä¿å­˜
            fullContentDiv.innerHTML = makeUrlsClickable(content); // ã‚¯ãƒªãƒƒã‚«ãƒ–ãƒ«URLã‚’é©ç”¨
            fullContentDiv.contentEditable = true; // ç·¨é›†å¯èƒ½ã«è¨­å®š
            fullContentDiv.style.display = 'block';
            saveButton.style.display = 'block';
            closeButton.style.display = 'block';
            fullContentDiv.scrollIntoView({ behavior: 'smooth' });

            // contenteditableå†…ã§ã®ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯ã‚’æœ‰åŠ¹åŒ–
            fullContentDiv.addEventListener('click', (e) => {
                if (e.target.tagName === 'A') {
                    e.preventDefault();
                    window.open(e.target.href, '_blank', 'noopener,noreferrer'); // æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
                }
            });
        }

        // è©³ç´°ã‚’é–‰ã˜ã‚‹é–¢æ•°
        function closeFullContent() {
            const fullContentDiv = document.getElementById('fullContent');
            const saveButton = document.getElementById('saveButton');
            const closeButton = document.getElementById('closeButton');

            fullContentDiv.style.display = 'none';
            saveButton.style.display = 'none';
            closeButton.style.display = 'none';
            currentKey = null; // ç¾åœ¨ã®keyã‚’ãƒªã‚»ãƒƒãƒˆ
        }

        // ä¿®æ­£å†…å®¹ã‚’ä¿å­˜ã™ã‚‹é–¢æ•°
        function saveChanges() {
            const fullContentDiv = document.getElementById('fullContent');
            const newContent = fullContentDiv.innerText; // ä¿®æ­£å¾Œã®å†…å®¹ã‚’å–å¾—ï¼ˆãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰

            if (currentKey) {
                localStorage.setItem(currentKey, newContent); // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
                alert('å†…å®¹ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
                searchMemos(); // æ¤œç´¢çµæœã‚’æ›´æ–°
            } else {
                alert('ä¿å­˜ã™ã‚‹å†…å®¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
            }
        }

        // ãƒ¡ãƒ¢ã®æ¤œç´¢ã¨è¡¨ç¤ºã‚’è¡Œã†é–¢æ•°
        function searchMemos() {
            const keyword = document.getElementById('keywordInput').value;
            const keys = Object.keys(localStorage).filter(key => key !== 'searchKeyword');
            const searchResults = keys.filter(key => {
                const content = localStorage.getItem(key);
                return content.includes(keyword); // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
            });

            searchResults.sort((a, b) => a.localeCompare(b));

            const searchResultsList = document.getElementById('searchResults');
            searchResultsList.innerHTML = '';

            const table = document.createElement('table');
            const headerRow = document.createElement('tr');
            const keywordHeader = document.createElement('th');
            keywordHeader.classList.add('keyword-column');
            keywordHeader.textContent = 'key';
            const contentHeader = document.createElement('th');
            contentHeader.classList.add('content-column');
            contentHeader.textContent = 'å†…å®¹';
            const actionsHeader = document.createElement('th');
            actionsHeader.classList.add('actions-column');
            actionsHeader.textContent = 'æ“ä½œ';
            headerRow.appendChild(keywordHeader);
            headerRow.appendChild(contentHeader);
            headerRow.appendChild(actionsHeader);
            table.appendChild(headerRow);

            searchResults.forEach(key => {
                const row = document.createElement('tr');
                const keywordCell = document.createElement('td');
                keywordCell.classList.add('keyword-column');
                const contentCell = document.createElement('td');
                contentCell.classList.add('content-column');
                const actionsCell = document.createElement('td');
                actionsCell.classList.add('actions-column');
                const content = localStorage.getItem(key);

                keywordCell.textContent = key.slice(0, 10);
                contentCell.textContent = content.slice(0, 30) + '...';

                const viewButton = document.createElement('button');
                viewButton.textContent = 'è¡¨ç¤º';
				viewButton.classList.add('btn-show-text'); // ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ                 
                viewButton.onclick = () => displayFullContent(content, key);

                actionsCell.appendChild(viewButton);
                row.appendChild(keywordCell);
                row.appendChild(contentCell);
                row.appendChild(actionsCell);
                table.appendChild(row);
            });

            searchResultsList.appendChild(table);
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
        window.onload = () => searchMemos();
    </script>

  
	  <!-- ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§è¡¨ç¤ºã•ã‚Œã‚‹Topãƒœã‚¿ãƒ³ 5/5 -->
	  <button class="top-button" id="topBtn" onclick="scrollToTop()">Top</button>

	  <!-- JavaScript -->
	  <script>
	    // Topã«æˆ»ã‚‹
	    function scrollToTop() {
	      window.scrollTo({
	        top: 0,
	        behavior: 'smooth'
	      });
	    }

	    // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ãƒœã‚¿ãƒ³è¡¨ç¤ºåˆ¶å¾¡
	    window.addEventListener("scroll", function () {
	      const topBtn = document.getElementById("topBtn");
	      if (window.scrollY > 300) {
	        topBtn.style.display = "block";
	      } else {
	        topBtn.style.display = "none";
	      }
	    });
	  </script>
	  
 	  
   	</div>
   	
	<footer style="text-align: center;">
	<br>
	  Â© 20250813 ettomio
	</footer>
     	
	<!-- HTMLæœ«å°¾ã«ã“ã‚Œã‚’è¿½åŠ  5/5 -->
	<div style="height: 80px;"></div>
   	       
</body>
</html>
